<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenTech Monitoring System</title>
    <style>
        /* Global Styles */
        :root {
            --primary: #2e7d32;
            --secondary: #4caf50;
            --light: #e8f5e9;
            --dark: #1b5e20;
            --danger: #f44336;
            --warning: #ff9800;
            --success: #4caf50;
            --info: #2196f3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 20px;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: var(--light);
        }
        
        .dashboard {
            padding: 2rem 0;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .dashboard-title {
            font-size: 1.8rem;
            color: var(--dark);
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--dark);
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 0.5rem 0;
            color: var(--primary);
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .greenhouse-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .greenhouse-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .greenhouse-card-header {
            padding: 1rem;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        
        .status-ok {
            background-color: var(--success);
        }
        
        .status-warning {
            background-color: var(--warning);
        }
        
        .status-critical {
            background-color: var(--danger);
        }
        
        .greenhouse-card-body {
            padding: 1rem;
        }
        
        .readings-list {
            list-style: none;
            margin-bottom: 1rem;
        }
        
        .readings-list li {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #eee;
        }
        
        .reading-label {
            font-weight: 500;
        }
        
        .reading-value {
            font-weight: 600;
        }
        
        .reading-normal {
            color: var(--success);
        }
        
        .reading-warning {
            color: var(--warning);
        }
        
        .reading-critical {
            color: var(--danger);
        }
        
        .btn-assign {
            width: 100%;
            padding: 0.7rem;
            background-color: var(--info);
            color: white;
        }
        
        .btn-assign:hover {
            background-color: #0b7dda;
        }
        
        .btn-resolve {
            width: 100%;
            margin-top: 0.5rem;
            padding: 0.7rem;
            background-color: var(--success);
            color: white;
        }
        
        .btn-resolve:hover {
            background-color: #3d8b40;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 2rem;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
            animation: modal-appear 0.3s ease-out;
        }
        
        @keyframes modal-appear {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: var(--dark);
        }
        
        .close-btn {
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .btn-cancel {
            background-color: #f1f1f1;
            color: #333;
        }
        
        .btn-cancel:hover {
            background-color: #e0e0e0;
        }
        
        .btn-submit {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-submit:hover {
            background-color: var(--dark);
        }
        
        footer {
            background-color: var(--primary);
            color: white;
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 2rem;
        }
        
        /* Charts container - OPTIMIZED */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .chart-card {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            height: 300px; /* Fixed height */
        }
        
        .chart-header {
            margin-bottom: 1rem;
            color: var(--dark);
            font-size: 1.2rem;
        }
        
        canvas {
            max-width: 100%;
            height: 220px !important; /* Fixed height */
        }
        
        /* Login Page Styles */
        .login-container {
            max-width: 400px;
            margin: 5rem auto;
            padding: 2rem;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .login-logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .login-subtitle {
            color: #666;
        }
        
        .login-form {
            margin-bottom: 1.5rem;
        }
        
        .form-footer {
            text-align: center;
            margin-top: 1.5rem;
            color: #666;
        }
        
        .form-footer a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .form-footer a:hover {
            text-decoration: underline;
        }
        
        /* Notification System */
        .notification-badge {
            position: relative;
            display: inline-block;
        }
        
        .notification-badge .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .notification-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .notification-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.3rem;
        }
        
        .notification-content {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            min-width: 300px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .notification-header {
            padding: 1rem;
            background-color: var(--primary);
            color: white;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notification-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .notification-item {
            padding: 1rem;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .notification-item:hover {
            background-color: #f9f9f9;
        }
        
        .notification-item.unread {
            background-color: #f0f7ff;
        }
        
        .notification-icon {
            margin-right: 0.8rem;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .notification-content-inner {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }
        
        .notification-message {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }
        
        .notification-time {
            color: #999;
            font-size: 0.8rem;
        }
        
        .notification-footer {
            padding: 0.8rem;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        .notification-footer a {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .notification-footer a:hover {
            text-decoration: underline;
        }
        
        .user-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .user-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .user-content {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .user-header {
            padding: 1rem;
            background-color: var(--primary);
            color: white;
            text-align: center;
        }
        
        .user-name {
            font-weight: bold;
            margin-bottom: 0.3rem;
        }
        
        .user-role {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .user-menu {
            list-style: none;
        }
        
        .user-menu li {
            border-bottom: 1px solid #eee;
        }
        
        .user-menu li:last-child {
            border-bottom: none;
        }
        
        .user-menu a {
            display: block;
            padding: 0.8rem 1rem;
            color: #333;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        
        .user-menu a:hover {
            background-color: #f5f5f5;
        }
        
        .user-menu .logout {
            color: var(--danger);
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
        }
        
        .toast {
            background-color: white;
            border-left: 4px solid var(--primary);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 4px;
            padding: 1rem;
            margin-bottom: 1rem;
            min-width: 300px;
            max-width: 400px;
            animation: toast-appear 0.3s ease-out;
            display: flex;
            align-items: flex-start;
            position: relative;
        }
        
        @keyframes toast-appear {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast-success {
            border-left-color: var(--success);
        }
        
        .toast-warning {
            border-left-color: var(--warning);
        }
        
        .toast-error {
            border-left-color: var(--danger);
        }
        
        .toast-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
        }
        
        .toast-success .toast-icon {
            color: var(--success);
        }
        
        .toast-warning .toast-icon {
            color: var(--warning);
        }
        
        .toast-error .toast-icon {
            color: var(--danger);
        }
        
        .toast-body {
            flex: 1;
        }
        
        .toast-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }
        
        .toast-message {
            color: #666;
            font-size: 0.9rem;
        }
        
        .toast-close {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            color: #999;
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-links {
                margin-top: 1rem;
                flex-direction: column;
                width: 100%;
            }
            
            .nav-links li {
                margin: 0;
                margin-bottom: 0.5rem;
                text-align: center;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .stat-card {
                padding: 1rem;
            }
            
            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 1rem;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .chart-card {
                height: 250px;
            }
            
            canvas {
                height: 170px !important;
            }
            
            .notification-content {
                min-width: 280px;
                right: -50px;
            }
        }
    </style>
</head>
<body>
    <div id="login-page" style="display:none;">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">GreenTech</div>
                <div class="login-subtitle">Greenhouse Monitoring System</div>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="email" class="form-label">Email Address</label>
                    <input type="email" id="email" name="email" class="form-control" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" id="password" name="password" class="form-control" required placeholder="Enter your password">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Log In</button>
                <div class="form-footer">
                    <p>Forgot your password? <a href="#">Reset Password</a></p>
                </div>
            </form>
        </div>
    </div>

    <div id="main-app">
        <header>
            <div class="container">
                <nav class="navbar">
                    <div class="logo">GreenTech Monitoring System</div>
                    <ul class="nav-links">
                        <li><a href="#dashboard">Dashboard</a></li>
                        <li><a href="#greenhouses">Greenhouses</a></li>
                        <li><a href="#reports">Reports</a></li>
                        <li><a href="#employees">Employees</a></li>
                        <li><a href="#settings">Settings</a></li>
                        <li class="notification-dropdown">
                            <button class="notification-btn notification-badge" id="notificationBtn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                                </svg>
                                <span class="badge" id="notificationCount">3</span>
                            </button>
                            <div class="notification-content" id="notificationDropdown">
                                <div class="notification-header">
                                    <span>Notifications</span>
                                    <button id="markAllRead" style="background:none; border:none; color:white; font-size:0.8rem; cursor:pointer;">Mark all as read</button>
                                </div>
                                <div class="notification-list">
                                    <div class="notification-item unread">
                                        <div class="notification-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                            </svg>
                                        </div>
                                        <div class="notification-content-inner">
                                            <div class="notification-title">Critical Alert - Greenhouse #1</div>
                                            <div class="notification-message">Temperature is critically high (38°C)</div>
                                            <div class="notification-time">Just now</div>
                                        </div>
                                    </div>
                                    <div class="notification-item unread">
                                        <div class="notification-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                                            </svg>
                                        </div>
                                        <div class="notification-content-inner">
                                            <div class="notification-title">Warning - Greenhouse #2</div>
                                            <div class="notification-message">Humidity is above normal levels (78%)</div>
                                            <div class="notification-time">5 minutes ago</div>
                                        </div>
                                    </div>
                                    <div class="notification-item unread">
                                        <div class="notification-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                            </svg>
                                        </div>
                                        <div class="notification-content-inner">
                                            <div class="notification-title">Issue Resolved - Greenhouse #4</div>
                                            <div class="notification-message">All parameters have returned to normal</div>
                                            <div class="notification-time">20 minutes ago</div>
                                        </div>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                                <circle cx="9" cy="7" r="4"></circle>
                                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                            </svg>
                                        </div>
                                        <div class="notification-content-inner">
                                            <div class="notification-title">New Assignment</div>
                                            <div class="notification-message">You have been assigned to Greenhouse #5</div>
                                            <div class="notification-time">1 hour ago</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="notification-footer">
                                    <a href="#">View all notifications</a>
                                </div>
                            </div>
                        </li>
                        <li class="user-dropdown">
                            <button class="user-btn" id="userBtn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                                <span>John Smith</span>
                            </button>
                            <div class="user-content" id="userDropdown">
                                <div class="user-header">
                                    <div class="user-name">John Smith</div>
                                    <div class="user-role">Administrator</div>
                                </div>
                                <ul class="user-menu">
                                    <li><a href="#">My Profile</a></li>
                                    <li><a href="#">Account Settings</a></li>
                                    <li><a href="#" class="logout" id="logoutBtn">Logout</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <main class="container">
            <section class="dashboard" id="dashboard">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">Greenhouse Monitoring Dashboard</h1>
                    <button class="btn btn-primary" id="refreshBtn">Refresh Data</button>
                </div>

                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="totalGreenhousesValue">12</div>
                        <div class="stat-label">Total Greenhouses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="criticalIssuesValue">3</div>
                        <div class="stat-label">Critical Issues</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="warningIssuesValue">5</div>
                        <div class="stat-label">Warning Issues</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="resolvedTodayValue">8</div>
                        <div class="stat-label">Issues Resolved Today</div>
                    </div>
                </div>

                <h2>Greenhouse Status</h2>
                <div class="greenhouse-grid" id="greenhouseGrid">
                    <!-- Greenhouse cards will be dynamically generated -->
                    <div class="greenhouse-card">
                        <div class="greenhouse-card-header">
                            <h3>Greenhouse #1</h3>
                            <div>
                                <span class="status-indicator status-critical"></span>
                                Critical
                            </div>
                        </div>
                        <div class="greenhouse-card-body">
                            <ul class="readings-list">
                                <li>
                                    <span class="reading-label">Temperature</span>
                                    <span class="reading-value reading-critical">38°C</span>
                                </li>
                                <li>
                                    <span class="reading-label">Humidity</span>
                                    <span class="reading-value reading-normal">65%</span>
                                </li>
                                <li>
                                    <span class="reading-label">Air Quality</span>
                                    <span class="reading-value reading-warning">Fair</span>
                                </li>
                                <li>
                                    <span class="reading-label">Soil Moisture</span>
                                    <span class="reading-value reading-normal">Good</span>
                                </li>
                            </ul>
                            <button class="btn btn-assign" data-id="1">Assign Employee</button>
                            <button class="btn btn-resolve" data-id="1">Mark as Resolved</button>
                        </div>
                    </div>

                    <div class="greenhouse-card">
                        <div class="greenhouse-card-header">
                            <h3>Greenhouse #2</h3>
                            <div>
                                <span class="status-indicator status-warning"></span>
                                Warning
                            </div>
                        </div>
                        <div class="greenhouse-card-body">
                            <ul class="readings-list">
                                <li>
                                    <span class="reading-label">Temperature</span>
                                    <span class="reading-value reading-normal">25°C</span>
                                </li>
                                <li>
                                    <span class="reading-label">Humidity</span>
                                    <span class="reading-value reading-warning">78%</span>
                                </li>
                                <li>
                                    <span class="reading-label">Air Quality</span>
                                    <span class="reading-value reading-normal">Good</span>
                                </li>
                                <li>
                                    <span class="reading-label">Soil Moisture</span>
                                    <span class="reading-value reading-warning">Low</span>
                                </li>
                            </ul>
                            <button class="btn btn-assign" data-id="2">Assign Employee</button>
                            <button class="btn btn-resolve" data-id="2">Mark as Resolved</button>
                        </div>
                    </div>

                    <div class="greenhouse-card">
                        <div class="greenhouse-card-header">
                            <h3>Greenhouse #3</h3>
                            <div>
                                <span class="status-indicator status-ok"></span>
                                Normal
                            </div>
                        </div>
                        <div class="greenhouse-card-body">
                            <ul class="readings-list">
                                <li>
                                    <span class="reading-label">Temperature</span>
                                    <span class="reading-value reading-normal">24°C</span>
                                </li>
                                <li>
                                    <span class="reading-label">Humidity</span>
                                    <span class="reading-value reading-normal">65%</span>
                                </li>
                                <li>
                                    <span class="reading-label">Air Quality</span>
                                    <span class="reading-value reading-normal">Good</span>
                                </li>
                                <li>
                                    <span class="reading-label">Soil Moisture</span>
                                    <span class="reading-value reading-normal">Good</span>
                                </li>
                            </ul>
                            <button class="btn btn-assign" data-id="3">Assign Employee</button>
                            <button class="btn btn-resolve" data-id="3" disabled>Mark as Resolved</button>
                        </div>
                    </div>

                    <div class="greenhouse-card">
                        <div class="greenhouse-card-header">
                            <h3>Greenhouse #4</h3>
                            <div>
                                <span class="status-indicator status-warning"></span>
                                Warning
                            </div>
                        </div>
                        <div class="greenhouse-card-body">
                            <ul class="readings-list">
                                <li>
                                    <span class="reading-label">Temperature</span>
                                    <span class="reading-value reading-normal">26°C</span>
                                </li>
                                <li>
                                    <span class="reading-label">Humidity</span>
                                    <span class="reading-value reading-normal">60%</span>
                                </li>
                                <li>
                                    <span class="reading-label">Air Quality</span>
                                    <span class="reading-value reading-warning">Fair</span>
                                </li>
                                <li>
                                    <span class="reading-label">Soil Moisture</span>
                                    <span class="reading-value reading-warning">Low</span>
                                </li>
                            </ul>
                            <button class="btn btn-assign" data-id="4">Assign Employee</button>
                            <button class="btn btn-resolve" data-id="4">Mark as Resolved</button>
                        </div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-card">
                        <h3 class="chart-header">Issue Trends (Last 30 Days)</h3>
                        <canvas id="issuesTrendChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-header">Current Issues by Type</h3>
                        <canvas id="issuesByTypeChart"></canvas>
                    </div>
                </div>
            </section>
        </main>

        <!-- Modal for assigning employee -->
        <div id="assignModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Assign Employee to Greenhouse</h2>
                    <span class="close-btn" id="closeAssignModal">&times;</span>
                </div>
                <form id="assignForm">
                    <input type="hidden" id="greenhouseId" name="greenhouseId">
                    <div class="form-group">
                        <label for="employee" class="form-label">Select Employee</label>
                        <select id="employee" name="employee" class="form-control" required>
                            <option value="">-- Select Employee --</option>
                            <option value="1">John Smith (Available)</option>
                            <option value="2">Emma Davis (Available)</option>
                            <option value="3">Michael Johnson (Available)</option>
                            <option value="4">Sophia Martinez (Busy)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="priority" class="form-label">Priority</label>
                        <select id="priority" name="priority" class="form-control" required>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                            <option value="critical">Critical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notes" class="form-label">Notes</label>
                        <textarea id="notes" name="notes" class="form-control" rows="3" placeholder="Add any specific instructions or notes for the employee"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancelAssign" class="btn btn-cancel">Cancel</button>
                        <button type="submit" class="btn btn-submit">Assign Employee</button>
                    </div>
                </form>
            </div>
        </div>

        <footer>
            <div class="container">
                <p>&copy; 2025 GreenTech Monitoring System. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Authentication state
            let isAuthenticated = false;
            
            // Check if user is authenticated (would be from sessionStorage in real app)
            const checkAuth = () => {
                if (isAuthenticated) {
                    document.getElementById('login-page').style.display = 'none';
                    document.getElementById('main-app').style.display = 'block';
                } else {
                    document.getElementById('login-page').style.display = 'block';
                    document.getElementById('main-app').style.display = 'none';
                }
            };
            
            // Initial auth check
            checkAuth();
            
            // Login form submission
            const loginForm = document.getElementById('login-form');
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                // Simple validation (in a real app, this would be a server request)
                if (email && password) {
                    // Simulate successful login
                    isAuthenticated = true;
                    
                    // In a real app, you would store the auth token in sessionStorage
                    // sessionStorage.setItem('token', 'your-auth-token');
                    
                    checkAuth();
                    
                    // Show welcome notification
                    showToast('success', 'Login Successful', 'Welcome to GreenTech Monitoring System');
                } else {
                    showToast('error', 'Login Failed', 'Invalid email or password');
                }
            });
            
            // Logout functionality
            const logoutBtn = document.getElementById('logoutBtn');
            logoutBtn.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Clear authentication
                isAuthenticated = false;
                
                // In a real app, you would clear the auth token
                // sessionStorage.removeItem('token');
                
                checkAuth();
            });

            // Toast notification system
            function showToast(type, title, message, duration = 5000) {
                const toastContainer = document.getElementById('toastContainer');
                
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                
                let iconSvg = '';
                if (type === 'success') {
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>';
                } else if (type === 'warning') {
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>';
                } else if (type === 'error') {
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>';
                } else {
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>';
                }
                
                toast.innerHTML = `
                    <div class="toast-icon">${iconSvg}</div>
                    <div class="toast-body">
                        <div class="toast-title">${title}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close">&times;</button>
                `;
                
                toastContainer.appendChild(toast);
                
                // Auto-remove toast after duration
                const toastTimeout = setTimeout(() => {
                    toast.remove();
                }, duration);
                
                // Close button functionality
                const closeBtn = toast.querySelector('.toast-close');
                closeBtn.addEventListener('click', () => {
                    clearTimeout(toastTimeout);
                    toast.remove();
                });
            }
            
            // User dropdown functionality
            const userBtn = document.getElementById('userBtn');
            const userDropdown = document.getElementById('userDropdown');
            
            userBtn.addEventListener('click', function() {
                userDropdown.style.display = userDropdown.style.display === 'block' ? 'none' : 'block';
                // Close notification dropdown if open
                notificationDropdown.style.display = 'none';
            });
            
            // Notification system functionality
            const notificationBtn = document.getElementById('notificationBtn');
            const notificationDropdown = document.getElementById('notificationDropdown');
            const notificationItems = document.querySelectorAll('.notification-item');
            const notificationCount = document.getElementById('notificationCount');
            const markAllReadBtn = document.getElementById('markAllRead');
            
            notificationBtn.addEventListener('click', function() {
                notificationDropdown.style.display = notificationDropdown.style.display === 'block' ? 'none' : 'block';
                // Close user dropdown if open
                userDropdown.style.display = 'none';
            });
            
            notificationItems.forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.remove('unread');
                    updateNotificationCount();
                });
            });
            
            markAllReadBtn.addEventListener('click', function() {
                document.querySelectorAll('.notification-item.unread').forEach(item => {
                    item.classList.remove('unread');
                });
                updateNotificationCount();
            });
            
            function updateNotificationCount() {
                const unreadCount = document.querySelectorAll('.notification-item.unread').length;
                notificationCount.textContent = unreadCount;
                
                if (unreadCount === 0) {
                    notificationCount.style.display = 'none';
                } else {
                    notificationCount.style.display = 'block';
                }
            }
            
            // Close dropdowns when clicking outside
            window.addEventListener('click', function(event) {
                if (!event.target.closest('.notification-dropdown') && !event.target.matches('.notification-btn')) {
                    notificationDropdown.style.display = 'none';
                }
                
                if (!event.target.closest('.user-dropdown') && !event.target.matches('.user-btn')) {
                    userDropdown.style.display = 'none';
                }
            });

            // Initialize charts - OPTIMIZED to reduce lag
            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 500 // Shorter animation duration
                },
                elements: {
                    line: {
                        tension: 0.3 // Less curved lines for better performance
                    },
                    point: {
                        radius: 3 // Smaller points for better performance
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            boxWidth: 12,
                            font: {
                                size: 11 // Smaller font for better performance
                            }
                        }
                    },
                    tooltip: {
                        enabled: true,
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            maxTicksLimit: 6 // Limit the number of ticks for better performance
                        }
                    },
                    x: {
                        ticks: {
                            maxTicksLimit: 10, // Limit the number of ticks for better performance
                            maxRotation: 0, // Prevent label rotation for better performance
                            font: {
                                size: 10 // Smaller font for better performance
                            }
                        }
                    }
                }
            };
            
            // Issues Trend Chart
            const trendCtx = document.getElementById('issuesTrendChart').getContext('2d');
            const issuesTrendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['1', '5', '10', '15', '20', '25', '30'], // Simplified labels
                    datasets: [
                        {
                            label: 'Critical Issues',
                            data: [3, 4, 2, 5, 3, 2, 3],
                            borderColor: '#f44336',
                            backgroundColor: 'rgba(244, 67, 54, 0.1)',
                            borderWidth: 2
                        },
                        {
                            label: 'Warning Issues',
                            data: [5, 7, 6, 8, 5, 7, 6],
                            borderColor: '#ff9800',
                            backgroundColor: 'rgba(255, 152, 0, 0.1)',
                            borderWidth: 2
                        },
                        {
                            label: 'Resolved Issues',
                            data: [7, 9, 8, 11, 8, 10, 9],
                            borderColor: '#4caf50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            borderWidth: 2
                        }
                    ]
                },
                options: chartOptions
            });

            // Issues by Type Chart
            const typeCtx = document.getElementById('issuesByTypeChart').getContext('2d');
            const issuesByTypeChart = new Chart(typeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Temperature', 'Humidity', 'Air Quality', 'Soil Moisture', 'Light', 'Water'],
                    datasets: [{
                        data: [4, 7, 2, 5, 3, 1],
                        backgroundColor: [
                            '#f44336',
                            '#ff9800',
                            '#2196f3',
                            '#4caf50',
                            '#9c27b0',
                            '#03a9f4'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    cutout: '60%',
                    animation: {
                        duration: 500 // Shorter animation duration
                    }
                }
            });

            // Modal functionality
            const assignModal = document.getElementById('assignModal');
            const assignButtons = document.querySelectorAll('.btn-assign');
            const closeModal = document.getElementById('closeAssignModal');
            const cancelButton = document.getElementById('cancelAssign');
            const greenhouseIdInput = document.getElementById('greenhouseId');
            const assignForm = document.getElementById('assignForm');

            assignButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const greenhouseId = this.getAttribute('data-id');
                    greenhouseIdInput.value = greenhouseId;
                    assignModal.style.display = 'block';
                });
            });

            function closeAssignModal() {
                assignModal.style.display = 'none';
                assignForm.reset();
            }

            closeModal.addEventListener('click', closeAssignModal);
            cancelButton.addEventListener('click', closeAssignModal);

            window.addEventListener('click', function(event) {
                if (event.target === assignModal) {
                    closeAssignModal();
                }
            });

            assignForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Simulate API request
                const formData = new FormData(assignForm);
                const greenhouseId = formData.get('greenhouseId');
                const employeeId = formData.get('employee');
                const priority = formData.get('priority');
                const notes = formData.get('notes');
                
                console.log('Assignment submitted:', {
                    greenhouseId,
                    employeeId,
                    priority,
                    notes
                });
                
                // Show success notification
                showToast('success', 'Employee Assigned', `Employee successfully assigned to Greenhouse #${greenhouseId}`);
                closeAssignModal();
            });

            // Resolve buttons functionality
            const resolveButtons = document.querySelectorAll('.btn-resolve:not([disabled])');
            resolveButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const greenhouseId = this.getAttribute('data-id');
                    
                    // Confirm with user
                    if (confirm(`Are you sure you want to mark Greenhouse #${greenhouseId} issues as resolved?`)) {
                        console.log(`Marked Greenhouse #${greenhouseId} as resolved`);
                        
                        // Show success notification
                        showToast('success', 'Issue Resolved', `Greenhouse #${greenhouseId} issues have been marked as resolved.`);
                        
                        // In a real app, this would update the UI based on API response
                        const card = this.closest('.greenhouse-card');
                        const statusIndicator = card.querySelector('.status-indicator');
                        const statusText = statusIndicator.nextSibling;
                        
                        statusIndicator.className = 'status-indicator status-ok';
                        statusText.textContent = ' Normal';
                        this.disabled = true;
                    }
                });
            });

            // Refresh button functionality
            const refreshBtn = document.getElementById('refreshBtn');
            refreshBtn.addEventListener('click', function() {
                // In a real app, this would fetch fresh data from the API
                this.textContent = 'Refreshing...';
                
                setTimeout(() => {
                    // Simulate data refresh
                    document.getElementById('criticalIssuesValue').textContent = Math.floor(Math.random() * 5);
                    document.getElementById('warningIssuesValue').textContent = Math.floor(Math.random() * 7 + 3);
                    document.getElementById('resolvedTodayValue').textContent = Math.floor(Math.random() * 10 + 5);
                    
                    // Update charts with new random data
                    issuesTrendChart.data.datasets.forEach((dataset, i) => {
                        const baseValues = [
                            [3, 4, 2, 5, 3, 2, 3],  // Critical
                            [5, 7, 6, 8, 5, 7, 6],  // Warning
                            [7, 9, 8, 11, 8, 10, 9] // Resolved
                        ];
                        
                        // Random variation to base values
                        dataset.data = baseValues[i].map(value => {
                            const variance = Math.floor(Math.random() * 3) - 1; // -1, 0, or 1
                            return Math.max(0, value + variance);
                        });
                    });
                    issuesTrendChart.update();
                    
                    const newTypeData = [
                        Math.floor(Math.random() * 5 + 2),
                        Math.floor(Math.random() * 5 + 3),
                        Math.floor(Math.random() * 3 + 1),
                        Math.floor(Math.random() * 5 + 2),
                        Math.floor(Math.random() * 4 + 1),
                        Math.floor(Math.random() * 3 + 1)
                    ];
                    issuesByTypeChart.data.datasets[0].data = newTypeData;
                    issuesByTypeChart.update();
                    
                    this.textContent = 'Refresh Data';
                    
                    // Show notification for successful refresh
                    showToast('info', 'Data Refreshed', 'Dashboard data has been updated successfully');
                    
                    // Create a new notification
                    if (Math.random() > 0.5) {
                        const notificationList = document.querySelector('.notification-list');
                        const newNotification = document.createElement('div');
                        newNotification.className = 'notification-item unread';
                        
                        const randomGreenhouse = Math.floor(Math.random() * 8) + 1;
                        const issues = ['Temperature', 'Humidity', 'Air Quality', 'Soil Moisture'];
                        const randomIssue = issues[Math.floor(Math.random() * issues.length)];
                        
                        newNotification.innerHTML = `
                            <div class="notification-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" y1="8" x2="12" y2="12"></line>
                                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                </svg>
                            </div>
                            <div class="notification-content-inner">
                                <div class="notification-title">New Alert - Greenhouse #${randomGreenhouse}</div>
                                <div class="notification-message">${randomIssue} is outside normal range</div>
                                <div class="notification-time">Just now</div>
                            </div>
                        `;
                        
                        notificationList.insertBefore(newNotification, notificationList.firstChild);
                        updateNotificationCount();
                        
                        // Show toast for the new alert
                        showToast('warning', `New Alert - Greenhouse #${randomGreenhouse}`, `${randomIssue} is outside normal range`);
                    }
                }, 1000);
            });
            
            // Simulate real-time notifications
            setInterval(() => {
                if (Math.random() > 0.85 && isAuthenticated) {
                    const randomGreenhouse = Math.floor(Math.random() * 12) + 1;
                    const issues = ['Temperature', 'Humidity', 'Air Quality', 'Soil Moisture', 'Light Level', 'Water Supply'];
                    const randomIssue = issues[Math.floor(Math.random() * issues.length)];
                    
                    const notificationList = document.querySelector('.notification-list');
                    const newNotification = document.createElement('div');
                    newNotification.className = 'notification-item unread';
                    
                    newNotification.innerHTML = `
                        <div class="notification-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                        </div>
                        <div class="notification-content-inner">
                            <div class="notification-title">Real-time Alert - Greenhouse #${randomGreenhouse}</div>
                            <div class="notification-message">${randomIssue} requires attention</div>
                            <div class="notification-time">Just now</div>
                        </div>
                    `;
                    
                    notificationList.insertBefore(newNotification, notificationList.firstChild);
                    updateNotificationCount();
                    
                    // Show toast for the new alert
                    showToast('warning', `Real-time Alert - Greenhouse #${randomGreenhouse}`, `${randomIssue} requires attention`);
                    
                    // Also update the notification badge
                    notificationCount.textContent = parseInt(notificationCount.textContent) + 1;
                    notificationCount.style.display = 'block';
                }
            }, 60000); // Check for new notifications every minute
        });
    </script>
</body>
</html>
